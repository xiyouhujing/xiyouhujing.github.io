---
title: 数据库笔记（一）
date: 2020-07-31 12:57:34
tags: 
- 数据库
copyright: true
categories: 数据库
mathjax: true
---

### 数据库分类

**1.关系型数据库**

时下流行的是Oracle、MySql、MS  SQL Server、PostGreSQL、DB2等

<!--  more -->

**2.Nosql数据库**

| 类型       | 数据库           |
| ---------- | ---------------- |
| 键值数据库 | Redis、Memcached |
| 列数据库   | Cassandra、Hbase |
| 文档数据库 | MongoDB、CouchDB |
| 图形数据库 | Neo4J、InforGrid |

### 数据库系统的组成

![](https://raw.githubusercontent.com/xiyouhujing/TyporaPic/master/img/%E6%95%B0%E6%8D%AE%E5%BA%93/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E6%9E%84%E6%88%90.jpg)

- 数据（Data）

  对客观事物的符号表示，如图形符号、数字、字母等，数据是数据库中存储的基本对象。

- 数据库（Database）

  存储在一起的相关数据的集合，这些数据是结构化的，无有害的或不必要的冗余，并为多种应用服务

- 数据库管理系统（DBMS）

  操纵和管理数据库的大型软件，是应用于建立、使用和维护数据库，简称DBMS。关系型数据库管理系统称为RDBMS

- 数据库系统（DBS）

  实际可运行的存储、维护和应用系统提供数据的软件系统。包括DBMS、DB、应用软件、数据库管理员、用户

#### 数据

数据种类：文字、图形、图像、声音

数据特点：数据与语义不可分

例如：

数据：张华，男，1984，上海，计算机系，2003

语义：学生姓名、性别、出生年份、籍贯、所在系别、入学时间

#### 数据库管理系统

1.数据定义功能

- 提供数据定义语言（DDL）
- 定义数据库中的数据对象

2.数据操作功能

* 提供数据操纵语言（DML）
* 操纵数据实现对数据库的基本操作（查询、插入、删除和修改）

3.数据库运行管理

* 保证数据的安全性、完整性、多用户对数据的并发使用
* 发生故障后的系统恢复

4.数据库维护管理

* 数据库数据批量装载
* 数据库转储
* 介质故障恢复
* 数据库的重组织
* 性能监视等

### 关系型数据库的完整性和安全性

* **完整性**

1. **域完整性**：是对数据表中**字段属性**的约束，通常指数据的有效性。包括字段的值域、类型及有效规则等约束。

2. **实体完整性**：是对关系中的记录唯一性，也就是**主键**的约束。主键值不能为Null且不能是相同值
3. **参照完整性**：关系数据库中建立关联关系的数据表间数据参照引用的约束，也就是对**外键**的约束。外键必须是另一个关系的主键有效值，或者是NULL

* **安全性**

数据库的安全机制：

1. 自主安全性机制：存取控制。确保用户对数据库只能进行经过授权的有关操作
2. 强制安全性机制：用户标识与鉴别。通过对数据和用户强制分类，使得不同的用户能够访问不同类别的数据

### 关系型数据库的三个范式

1. **第一范式（1NF）**

**属性数据原子性**：数据库表的每一属性都是不可分割的，同一属性中不能有多个值。

2. **第二范式（2NF）**

**属性完全依赖于主属性**：要求数据库表中的每个记录的属性都完全依赖于主属性。

3. **第三范式（3NF）**

**属性不依赖于其他非主属性**：记录的每一个属性都于主属性直接相关而不是间接相关

4. **BC范式（BCNF）、第四范式**

实践中一般不用

> 范式间是传递依赖的，即满足第二范式，也就满足了第一范式，满足了第三范式也就满足了第二范式

### 关系型数据库的事务处理

* 事务的四个特性（ACID）：
  1. 原子性（Atomicity）：指事务包含的所有操作要么全部成功，要么全部失败回滚。
  2. 一致性（Consistency）：一致性规定事务提交前后只存在两个状态，提交前的状态和提交后的状态，绝对不会出现中间的状态。
  3. 隔离性（Isolation）：每个事务可以并发执行，但是他们互不干扰
  4. 持久性（Durabilily）：一个事务一旦被提交了，那么对数据库中的数据的改变就是永久性的

* 事务的控制语句：
  1. 开启事务（start transaction）
  2. 提交事务（commit）
  3. 回滚事务（rollback）

### 关系型数据库的并发控制

* 并发操作常见问题
  1. 更新丢失：两个更新语句同时修改一条数据
  2. 脏读：一个更新语句更新一条数据时，另一个读取数据读取了还没提交的更新
  3. 非重复读：一个读取语句读取了一条数据时，另一个更新语句修改了这条数据
  4. 幻读：一个读取语句读取时，另一个插入语句插入了一条新数据，这样就可能多读出一条数据，出现幻读
* 事务隔离级别
  1. 读未提交数据：所有事务都可以看到其他未提交事务的执行结果
  2. 读已提交数据：一个事务只能看见已经提交事务所做的改变
  3. 可重复读：它确保同一事务的多个实例在并发读取数据时，会看到同样的数据行
  4. 可串行化：通过强制事务排序，使之不可能相互冲突，从而解决幻读问题

### 关系型数据库的锁

* 类型
  1. 共享锁：也称读锁，事务A对T加S锁，其他事务也只能对T加S，多个事务可以同时读，但不能有写操作，知道A释放S锁
  2. 排他锁：也称写锁，事务A对T加X锁以后，其他事务不能对T加任何所，只有事务A可以读写对象T知道A释放X锁

* 粒度
  1. 表级锁：直接锁定整张表，在锁定期间，其他进程无法对该表进行读写操作，如果是写锁，则其他进程读也不允许
  2. 行级锁：仅对指定的记录进行加锁，这样其他进程还是可以对同一个表中的其他记录进行操作
  3. 页级锁：一次锁定相邻的一组记录
* 使用机制
  1. 乐观锁：直到修改完数据，准备提交所做的修改到数据库的时候，才会将数据锁住
  2. 悲观锁：从数据开始更改时，就将数据锁住，知道更改完成才释放

